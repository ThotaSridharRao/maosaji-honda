<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maosaji Honda - User Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<script>
tailwind.config = {
    theme: {
        extend: {
            colors: {
                primary: '#e31837', /* Honda's primary red color */
                secondary: '#000000' /* Dark grey for text */
            },
            borderRadius: {
                'none': '0px',
                'sm': '4px',
                DEFAULT: '8px',
                'md': '12px',
                'lg': '16px',
                'xl': '20px',
                '2xl': '24px',
                '3xl': '32px',
                'full': '9999px',
                'button': '8px' /* Custom border-radius for buttons */
            }
        }
    }
};
</script>
<style>
/* Reset Remixicon content to allow individual icon display */
:where([class^="ri-"])::before { content: initial; } /* Remove default content to allow specific icon classes to work */

body {
    font-family: 'Poppins', sans-serif;
    scroll-behavior: smooth;
}
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #f0f9ff 0%, #e1f5fe 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    opacity: 1;
    transition: opacity 0.5s ease-out;
}
.loader {
    position: relative;
    width: 120px;
    height: 120px;
}
.loader-circle {
    position: absolute;
    width: 100%;
    height: 100%;
    border: 4px solid transparent;
    border-top-color: #3b82f6;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}
.loader-circle:nth-child(2) {
    width: 80%;
    height: 80%;
    top: 10%;
    left: 10%;
    border-top-color: #10b981;
    animation-duration: 1.3s;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
.logo-pulse {
    animation: pulse 2s infinite;
}
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}
.fade-in {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.8s ease, transform 0.8s ease;
}
.fade-in.appear {
    opacity: 1;
    transform: translateY(0);
}
.vehicle-card, .service-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.vehicle-card:hover, .service-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
}
/* Status colors for services */
.status-pending { background-color: #fef3c7; color: #d97706; } /* yellow-100, yellow-700 */
.status-in-progress { background-color: #bfdbfe; color: #1d4ed8; } /* blue-200, blue-800 */
.status-completed { background-color: #d1fae5; color: #065f46; } /* green-100, green-800 */
.status-ready-for-pickup { background-color: #bae6fd; color: #0369a1; } /* lightblue-100, lightblue-800 */
.status-cancelled { background-color: #fee2e2; color: #b91c1c; } /* red-100, red-700 */
.status-picked-up { background-color: #e0f2f7; color: #00838f; } /* teal-100, teal-700, custom for picked-up */


/* Custom Message Box Styles */
.message-box {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #4CAF50; /* Green for success */
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    min-width: 250px;
    text-align: center;
}
.message-box.error {
    background-color: #f44336; /* Red for error */
}
.message-box.show {
    opacity: 1;
}

/* Confirmation Modal Styles */
.confirmation-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}
.confirmation-modal.show {
    opacity: 1;
    visibility: visible;
}
.confirmation-modal-content {
    background-color: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    text-align: center;
    max-width: 400px;
    width: 90%;
    transform: translateY(20px);
    transition: transform 0.3s ease-in-out;
}
.confirmation-modal.show .confirmation-modal-content {
    transform: translateY(0);
}

/* Modal for viewing service details (for user) */
.view-service-details-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10002;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}
.view-service-details-modal.show {
    opacity: 1;
    visibility: visible;
}
.view-service-details-modal-content {
    background-color: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    max-width: 600px;
    width: 95%;
    max-height: 90%;
    overflow-y: auto; /* Enable scrolling for content if it overflows */
    transform: translateY(20px);
    transition: transform 0.3s ease-in-out;
}
.view-service-details-modal.show .view-service-details-modal-content {
    transform: translateY(0);
}
.view-service-details-modal-content ul li {
    padding: 0.5rem 0;
    border-bottom: 1px dashed #e5e7eb;
}
.view-service-details-modal-content ul li:last-child {
    border-bottom: none;
}
.view-service-details-modal-content .part-item {
    display: flex;
    justify-content: space-between;
    padding: 0.25rem 0;
}


</style>
</head>
<body>
<!-- Loading Screen -->
<div class="loading-screen" id="loading-screen">
    <div class="flex flex-col items-center">
        <div class="logo-pulse text-4xl font-['Pacifico'] text-primary mb-4">Maosaji Honda</div>
        <div class="loader">
            <div class="loader-circle"></div>
            <div class="loader-circle"></div>
        </div>
        <p class="mt-4 text-gray-600">Loading user dashboard...</p>
    </div>
</div>

<!-- Custom Message Box Container -->
<div id="custom-message-box" class="message-box hidden"></div>

<!-- Confirmation Modal -->
<div id="confirmation-modal" class="confirmation-modal">
    <div class="confirmation-modal-content">
        <h3 class="text-xl font-semibold mb-4 text-gray-800" id="confirmation-modal-title">Confirm Action</h3>
        <p class="text-gray-600 mb-6" id="confirmation-modal-message">Are you sure you want to proceed?</p>
        <div class="flex justify-center space-x-4">
            <button id="confirm-yes" class="px-6 py-3 bg-red-500 text-white rounded-button font-medium hover:bg-red-600 transition-colors">Yes</button>
            <button id="confirm-no" class="px-6 py-3 bg-gray-300 text-gray-800 rounded-button font-medium hover:bg-gray-400 transition-colors">No</button>
        </div>
    </div>
</div>

<!-- View Service Details Modal (for user) -->
<div id="view-service-details-modal" class="view-service-details-modal">
    <div class="view-service-details-modal-content">
        <h3 class="text-2xl font-bold mb-6 text-gray-800">Service Details</h3>
        <div id="service-details-content" class="text-gray-700 text-left">
            <ul class="space-y-2 mb-6">
                <li><span class="font-semibold">Vehicle:</span> <span id="detail-vehicle"></span></li>
                <li><span class="font-semibold">License Plate:</span> <span id="detail-license-plate"></span></li>
                <li><span class="font-semibold">Service Date:</span> <span id="detail-date"></span></li>
                <li><span class="font-semibold">Status:</span> <span id="detail-status"></span></li>
                <li><span class="font-semibold">Description:</span> <span id="detail-description"></span></li>
                <li><span class="font-semibold">Estimated Cost:</span> <span id="detail-estimated-cost"></span></li>
                <li><span class="font-semibold">Total Bill:</span> <span id="detail-total-bill"></span></li>
            </ul>
            <h4 class="text-lg font-semibold mb-3 text-gray-800">Parts Used</h4>
            <div id="detail-parts-used" class="bg-gray-50 p-4 rounded-lg">
                <!-- Parts will be dynamically loaded here -->
                <p id="no-parts-message" class="text-gray-500 text-sm italic hidden">No parts listed.</p>
            </div>
            <button type="button" id="close-service-details-btn" class="mt-8 px-6 py-3 bg-primary text-white rounded-button font-medium hover:bg-opacity-90 transition-all w-full">
                Close
            </button>
        </div>
    </div>
</div>


<!-- Navigation (Header) -->
<nav class="bg-white shadow-md fixed w-full z-50 transition-all duration-300" id="navbar">
    <div class="container mx-auto px-4 py-3">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-2">
                <img src="https://static.readdy.ai/image/37ac7cf2068439d6c30c12e5ad957f85/cf039908287dcf84123e6dde02bea2bc.png" alt="Honda Logo" class="h-8">
                <a href="#" class="text-2xl font-bold text-primary">Maosaji Honda</a>
            </div>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#welcome" class="text-gray-700 hover:text-primary transition-colors duration-300">Welcome</a>
                <a href="#my-vehicles" class="text-gray-700 hover:text-primary transition-colors duration-300">My Vehicles</a>
                <a href="#book-service" class="text-gray-700 hover:text-primary transition-colors duration-300">Book Service</a>
                <a href="#my-services" class="text-gray-700 hover:text-primary transition-colors duration-300">My Services</a>
                <button id="logout-button" class="px-4 py-2 text-primary border border-primary hover:bg-primary hover:text-white transition-colors duration-300 !rounded-button whitespace-nowrap">Log Out</button>
            </div>
            <div class="md:hidden flex items-center">
                <button id="mobile-menu-button" class="w-10 h-10 flex items-center justify-center text-gray-500 hover:text-primary">
                    <i class="ri-menu-line ri-lg"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden mt-4 pb-2">
            <div class="flex flex-col space-y-3">
                <a href="#welcome" class="text-gray-700 hover:text-primary py-2 transition-colors duration-300">Welcome</a>
                <a href="#my-vehicles" class="text-gray-700 hover:text-primary py-2 transition-colors duration-300">My Vehicles</a>
                <a href="#book-service" class="text-gray-700 hover:text-primary py-2 transition-colors duration-300">Book Service</a>
                <a href="#my-services" class="text-gray-700 hover:text-primary py-2 transition-colors duration-300">My Services</a>
                <button id="logout-button-mobile" class="px-4 py-2 text-primary border border-primary hover:bg-primary hover:text-white transition-colors duration-300 !rounded-button whitespace-nowrap">Log Out</button>
            </div>
        </div>
    </div>
</nav>

<!-- User Dashboard Main Content -->
<main class="pt-24 pb-12 bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4">
        <!-- Welcome Section -->
        <section id="welcome" class="mb-12 fade-in">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Welcome, <span id="user-name" class="text-primary">User</span>!</h1>
            <p class="text-lg text-gray-600">Manage your vehicles and service appointments.</p>
        </section>

        <!-- My Vehicles Section -->
        <section id="my-vehicles" class="py-12 bg-white rounded-lg shadow-md mb-12 fade-in">
            <div class="px-8 py-6 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-800">My Vehicles</h2>
                <button id="open-add-vehicle-modal" class="px-4 py-2 bg-primary text-white rounded-button font-medium hover:bg-opacity-90 transition-all flex items-center">
                    <i class="ri-add-line mr-2"></i> Add New Vehicle
                </button>
            </div>
            <div id="vehicle-list" class="p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Vehicle cards will be dynamically loaded here -->
            </div>
            <!-- Message for no vehicles -->
            <div id="no-vehicles-message" class="p-8 text-center text-gray-500 hidden">
                <i class="ri-car-line text-6xl mb-4"></i>
                <p class="text-xl font-medium mb-4">No vehicles added yet!</p>
                <p>Add your motorcycle to get started with service bookings.</p>
            </div>
        </section>

        <!-- Add Vehicle Modal -->
        <div id="add-vehicle-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white p-8 rounded-lg shadow-lg w-11/12 max-w-md">
                <h3 class="text-2xl font-bold mb-6 text-gray-800">Add New Vehicle</h3>
                <form id="add-vehicle-form">
                    <div class="mb-4">
                        <label for="make" class="block text-gray-700 mb-2">Make</label>
                        <input type="text" id="make" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Honda" required>
                    </div>
                    <div class="mb-4">
                        <label for="model" class="block text-gray-700 mb-2">Model</label>
                        <input type="text" id="model" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Activa 6G" required>
                    </div>
                    <div class="mb-4">
                        <label for="year" class="block text-gray-700 mb-2">Year</label>
                        <input type="number" id="year" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="2020" min="1900" max="2099" required>
                    </div>
                    <div class="mb-6">
                        <label for="licensePlate" class="block text-gray-700 mb-2">License Plate</label>
                        <input type="text" id="licensePlate" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="UP65CD5678" required>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancel-add-vehicle" class="px-6 py-3 bg-gray-300 text-gray-800 rounded-button font-medium hover:bg-gray-400 transition-colors">Cancel</button>
                        <button type="submit" class="px-6 py-3 bg-primary text-white rounded-button font-medium hover:bg-opacity-90 transition-all">Add Vehicle</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Book Service Section -->
        <section id="book-service" class="py-12 bg-white rounded-lg shadow-md mb-12 fade-in">
            <div class="px-8 py-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800">Book a Service</h2>
            </div>
            <form id="book-service-form" class="p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label for="select-vehicle" class="block text-gray-700 mb-2">Select Your Vehicle</label>
                        <div class="relative">
                            <select id="select-vehicle" class="w-full px-4 py-3 border border-gray-300 rounded appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent pr-8" required>
                                <option value="" disabled selected>-- Select a vehicle --</option>
                                <!-- Vehicles will be dynamically loaded here -->
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <i class="ri-arrow-down-s-line text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="service-date" class="block text-gray-700 mb-2">Preferred Date</label>
                        <input type="date" id="service-date" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" required>
                    </div>
                    <div>
                        <label for="service-type" class="block text-gray-700 mb-2">Service Type</label>
                        <div class="relative">
                            <select id="service-type" class="w-full px-4 py-3 border border-gray-300 rounded appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent pr-8" required>
                                <option value="" disabled selected>-- Select service type --</option>
                                <option value="Oil Change">Oil Change</option>
                                <option value="Tire Rotation">Tire Rotation</option>
                                <option value="Brake Inspection">Brake Inspection</option>
                                <option value="Engine Diagnostic">Engine Diagnostic</option>
                                <option value="Fluid Check">Fluid Check</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <i class="ri-arrow-down-s-line text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="service-description" class="block text-gray-700 mb-2">Describe the Issue (Optional)</label>
                        <textarea id="service-description" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="e.g., 'Brakes making a squealing noise', 'Engine light is on'"></textarea>
                    </div>
                </div>
                <button type="submit" class="px-6 py-3 bg-primary text-white rounded-button font-medium hover:bg-opacity-90 transition-all flex items-center justify-center">
                    <i class="ri-calendar-check-line mr-2"></i> Book Service
                </button>
            </form>
        </section>

        <!-- My Services Section -->
        <section id="my-services" class="py-12 bg-white rounded-lg shadow-md fade-in">
            <div class="px-8 py-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800">My Service History & Status</h2>
            </div>
            <div id="service-history-list" class="p-8 space-y-4">
                <!-- Service history items will be dynamically loaded here -->
            </div>
            <!-- Message for no service history -->
            <div id="no-service-history-message" class="p-8 text-center text-gray-500 hidden">
                <i class="ri-tools-line text-6xl mb-4"></i>
                <p class="text-xl font-medium mb-4">No service history yet!</p>
                <p>Book your first service appointment above.</p>
            </div>
        </section>
    </div>
</main>

<!-- Map Section (Copied from index.html) -->
<section class="h-96 relative overflow-hidden">
    <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('https://public.readdy.ai/gen_page/map_placeholder_1280x720.png');"></div>
    <div class="absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-md w-full text-center">
            <h3 class="text-2xl font-semibold mb-4">Visit Our Location</h3>
            <p class="text-gray-600 mb-6">We're conveniently located in the heart of Automotive City with easy access and ample parking.</p>
            <button class="px-6 py-3 bg-primary text-white hover:bg-blue-600 transition-colors duration-300 !rounded-button whitespace-nowrap">
                <i class="ri-navigation-line mr-2"></i> Get Directions
            </button>
        </div>
    </div>
</section>

<!-- Footer (Copied from index.html) -->
<footer class="bg-gray-800 text-white pt-16 pb-8">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12">
            <!-- Company Info -->
            <div>
                <div class="flex items-center gap-2 mb-6">
                    <img src="https://static.readdy.ai/image/37ac7cf2068439d6c30c12e5ad957f85/cf039908287dcf84123e6dde02bea2bc.png" alt="Honda Logo" class="h-8">
                    <h3 class="text-xl font-bold text-primary">Maosaji Honda</h3>
                </div>
                <p class="text-gray-400 mb-6">Authorized Honda motorcycle service center providing professional maintenance to keep your bike performing at its best.</p>
                <div class="flex space-x-4">
                    <a href="#" class="w-10 h-10 rounded-full bg-gray-700 hover:bg-primary transition-colors duration-300 flex items-center justify-center">
                        <i class="ri-facebook-fill"></i>
                    </a>
                    <a href="#" class="w-10 h-10 rounded-full bg-gray-700 hover:bg-primary transition-colors duration-300 flex items-center justify-center">
                        <i class="ri-twitter-fill"></i>
                    </a>
                    <a href="#" class="w-10 h-10 rounded-full bg-gray-700 hover:bg-primary transition-colors duration-300 flex items-center justify- center">
                        <i class="ri-instagram-line"></i>
                    </a>
                    <a href="#" class="w-10 h-10 rounded-full bg-gray-700 hover:bg-primary transition-colors duration-300 flex items-center justify-center">
                        <i class="ri-youtube-fill"></i>
                    </a>
                </div>
            </div>
            <!-- Quick Links -->
            <div>
                <h4 class="text-lg font-semibold mb-6">Quick Links</h4>
                <ul class="space-y-3">
                    <li><a href="#welcome" class="text-gray-400 hover:text-white transition-colors duration-300">Welcome</a></li>
                    <li><a href="#my-vehicles" class="text-gray-400 hover:text-white transition-colors duration-300">My Vehicles</a></li>
                    <li><a href="#book-service" class="text-gray-400 hover:text-white transition-colors duration-300">Book Service</a></li>
                    <li><a href="#my-services" class="text-gray-400 hover:text-white transition-colors duration-300">My Services</a></li>
                </ul>
            </div>
            <!-- Services (Can link to specific dashboard sections or external service pages) -->
            <div>
                <h4 class="text-lg font-semibold mb-6">Our Services</h4>
                <ul class="space-y-3">
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Oil Change</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Brake Service</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Diagnostics</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Battery Service</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Engine Repair</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">A/C Service</a></li>
                </ul>
            </div>
            <!-- Newsletter -->
            <div>
                <h4 class="text-lg font-semibold mb-6">Newsletter</h4>
                <p class="text-gray-400 mb-6">Subscribe to our newsletter for the latest service offers and automotive tips.</p>
                <form class="mb-4">
                    <div class="flex">
                        <input type="email" placeholder="Your email address" class="px-4 py-3 bg-gray-700 text-white border-none rounded-l focus:outline-none focus:ring-2 focus:ring-primary flex-grow">
                        <button type="submit" class="px-4 py-3 bg-primary text-white rounded-r hover:bg-blue-600 transition-colors duration-300">
                            <i class="ri-send-plane-fill"></i>
                        </button>
                    </div>
                </form>
                <div class="flex items-center">
                    <div class="custom-switch" id="newsletter-switch">
                        <div class="switch-track"></div>
                        <div class="switch-thumb"></div>
                    </div>
                    <span class="ml-2 text-gray-400">Receive promotional emails</span>
                </div>
            </div>
        </div>
        <div class="pt-8 border-t border-gray-700 flex flex-col md:flex-row justify-between items-center">
            <p class="text-gray-400 text-center md:text-left mb-4 md:mb-0">© 2025 AutoCare Pro. All rights reserved.</p>
            <div class="flex space-x-6">
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Privacy Policy</a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Terms of Service</a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Cookie Policy</a>
            </div>
        </div>
    </div>
</footer>

<!-- Mobile Menu Script -->
<script id="mobile-menu-script">
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton.addEventListener('click', function() {
        mobileMenu.classList.toggle('hidden');
    });
    // Close mobile menu when clicking on a link
    const mobileLinks = mobileMenu.querySelectorAll('a');
    mobileLinks.forEach(link => {
        link.addEventListener('click', function() {
            mobileMenu.classList.add('hidden');
        });
    });
});
</script>

<!-- Loading Screen Script -->
<script id="loading-screen-script">
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
        const loadingScreen = document.getElementById('loading-screen');
        loadingScreen.style.opacity = '0';
        setTimeout(function() {
            loadingScreen.style.display = 'none';
        }, 500);
    }, 2000); // Display loading screen for 2 seconds
});
</script>

<!-- Scroll Animation Script -->
<script id="scroll-animation-script">
document.addEventListener('DOMContentLoaded', function() {
    const fadeElements = document.querySelectorAll('.fade-in');
    function checkFade() {
        fadeElements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            const elementBottom = element.getBoundingClientRect().bottom;
            const isVisible = (elementTop < window.innerHeight - 100) && (elementBottom > 0);
            if (isVisible) {
                element.classList.add('appear');
            }
        });
    }
    // Initial check
    checkFade();
    // Check on scroll
    window.addEventListener('scroll', checkFade);
});
</script>

<!-- User Dashboard Specific Scripts -->
<script id="user-dashboard-script">
    // Define the base URL for your deployed backend
    const BASE_URL = 'https://honda-backend-ezro.onrender.com'; // Replace with your actual Render URL

    // Helper function to display custom messages (success/error)
    function showMessage(message, type = 'success') {
        const msgBox = document.getElementById('custom-message-box');
        msgBox.textContent = message;
        msgBox.className = `message-box show ${type}`; // Add 'show' and type class
        setTimeout(() => {
            msgBox.classList.remove('show');
            setTimeout(() => msgBox.classList.add('hidden'), 500); // Hide after fade out
        }, 3000); // Message visible for 3 seconds
        msgBox.classList.remove('hidden'); // Ensure it's not hidden if re-shown quickly
    }

    // Function to get JWT token from local storage
    function getToken() {
        return localStorage.getItem('token');
    }

    // Function to decode JWT token and get user info (basic, for client-side display)
    function decodeToken(token) {
        try {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        } catch (error) {
            console.error("Error decoding token:", error);
            return null;
        }
    }

    // Function to check authentication and redirect if not authenticated
    async function checkAuthAndRedirect() {
        const token = getToken();
        if (!token) {
            showMessage('You are not logged in. Redirecting to login page.', 'error');
            setTimeout(() => {
                window.location.href = 'login.html';
            }, 1500);
            return false;
        }
        return true;
    }

    // Function to update the visibility of the "no vehicles" message
    const updateNoVehiclesMessage = () => {
        const vehicleList = document.getElementById('vehicle-list');
        const noVehiclesMessage = document.getElementById('no-vehicles-message');
        if (vehicleList.children.length === 0) {
            noVehiclesMessage.classList.remove('hidden');
        } else {
            noVehiclesMessage.classList.add('hidden');
        }
    };

    // Function to update the visibility of the "no service history" message
    const updateNoServiceHistoryMessage = () => {
        const serviceHistoryList = document.getElementById('service-history-list');
        const noServiceHistoryMessage = document.getElementById('no-service-history-message');
        if (serviceHistoryList.children.length === 0) {
            noServiceHistoryMessage.classList.remove('hidden');
        } else {
            noServiceHistoryMessage.classList.add('hidden');
        }
    };

    // Function to render a single vehicle card
    function renderVehicleCard(vehicle) {
        const vehicleCardHtml = `
            <div class="vehicle-card bg-white p-6 rounded-lg shadow-sm flex flex-col justify-between">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-motorcycle-line ri-xl text-primary"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800">${vehicle.make} ${vehicle.model}</h3>
                    </div>
                    <ul class="text-gray-600 space-y-2 text-sm">
                        <li><span class="font-medium">Year:</span> ${vehicle.year}</li>
                        <li><span class="font-medium">License Plate:</span> ${vehicle.licensePlate}</li>
                    </ul>
                </div>
                <button data-vehicle-id="${vehicle._id}" class="delete-vehicle-btn mt-6 px-4 py-2 bg-red-500 text-white rounded-button text-sm hover:bg-red-600 transition-colors flex items-center justify-center">
                    <i class="ri-delete-bin-line mr-2"></i> Delete Vehicle
                </button>
            </div>
        `;
        return vehicleCardHtml;
    }

    // Global variable to store fetched services for easy access in modals
    let userServices = []; 

    // Function to render a single service history item
    function renderServiceHistoryItem(service) {
        const serviceDate = new Date(service.date).toLocaleDateString();
        const make = service.vehicleId ? service.vehicleId.make : 'N/A';
        const model = service.vehicleId ? service.vehicleId.model : 'N/A';
        const licensePlate = service.vehicleId ? service.vehicleId.licensePlate : 'N/A';
        const serviceType = service.type;
        const serviceStatusClass = `status-${service.type.toLowerCase().replace(/\s/g, '-')}`;
        const totalBill = service.totalBill ? `₹${service.totalBill.toFixed(2)}` : 'N/A';

        let partsListHtml = '';
        if (service.partsUsed && service.partsUsed.length > 0) {
            partsListHtml = `
                <p class="text-sm text-gray-700 font-medium mt-2">Parts Used:</p>
                <ul class="list-disc list-inside text-xs text-gray-600 ml-4">
                    ${service.partsUsed.map(part => `<li>${part.partName} (x${part.quantity}) - ₹${part.unitCost.toFixed(2)} each</li>`).join('')}
                </ul>
            `;
        }

        const serviceItemHtml = `
            <div class="service-card bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-xl font-semibold text-gray-800">Service for ${make} ${model}</h3>
                    <span class="px-3 py-1 rounded-full text-xs font-semibold uppercase ${serviceStatusClass}">
                        ${serviceType.replace(/-/g, ' ')}
                    </span>
                </div>
                <ul class="text-gray-600 space-y-1 text-sm mb-4">
                    <li><span class="font-medium">License Plate:</span> ${licensePlate}</li>
                    <li><span class="font-medium">Date:</span> ${serviceDate}</li>
                    <li><span class="font-medium">Description:</span> ${service.description || 'N/A'}</li>
                    <li><span class="font-medium">Estimated Cost:</span> ₹${service.cost ? service.cost.toFixed(2) : '0.00'}</li>
                    <li><span class="font-medium">Total Bill:</span> ${totalBill}</li>
                </ul>
                ${partsListHtml}
                <button data-service-id="${service._id}" class="view-service-details-btn mt-4 px-4 py-2 bg-blue-500 text-white rounded-button text-sm hover:bg-blue-600 transition-colors flex items-center justify-center">
                    <i class="ri-information-line mr-2"></i> View Details
                </button>
            </div>
        `;
        return serviceItemHtml;
    }

    // Function to fetch and display user's vehicles
    async function fetchAndDisplayVehicles() {
        const vehicleList = document.getElementById('vehicle-list');
        vehicleList.innerHTML = ''; // Clear existing vehicles

        const token = getToken();
        if (!token) return;

        try {
            const response = await fetch(`${BASE_URL}/api/vehicles`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'x-auth-token': token
                }
            });

            const data = await response.json();

            if (response.ok) {
                if (data.length > 0) {
                    data.forEach(vehicle => {
                        vehicleList.insertAdjacentHTML('beforeend', renderVehicleCard(vehicle));
                    });
                    populateVehicleSelect(data); // Populate the select dropdown for booking
                } else {
                    populateVehicleSelect([]); // Clear the select dropdown
                }
            } else {
                showMessage(data.msg || 'Failed to fetch vehicles.', 'error');
            }
        } catch (error) {
            console.error('Error fetching vehicles:', error);
            showMessage('Network error while fetching vehicles.', 'error');
        } finally {
            updateNoVehiclesMessage(); // Update message visibility
        }
    }

    // Function to populate the vehicle select dropdown for booking a service
    function populateVehicleSelect(vehicles) {
        const selectElement = document.getElementById('select-vehicle');
        selectElement.innerHTML = '<option value="" disabled selected>-- Select a vehicle --</option>'; // Reset dropdown

        if (vehicles && vehicles.length > 0) {
            vehicles.forEach(vehicle => {
                const option = document.createElement('option');
                option.value = vehicle._id;
                option.textContent = `${vehicle.make} ${vehicle.model} (${vehicle.licensePlate})`;
                selectElement.appendChild(option);
            });
        }
    }

    // Function to fetch and display user's service history
    async function fetchAndDisplayServiceHistory() {
        const serviceHistoryList = document.getElementById('service-history-list');
        serviceHistoryList.innerHTML = ''; // Clear existing history items

        const token = getToken();
        if (!token) return;

        try {
            const response = await fetch(`${BASE_URL}/api/services`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'x-auth-token': token
                }
            });

            const data = await response.json();

            if (response.ok) {
                userServices = data; // Store services globally for modal access
                if (data.length > 0) {
                    // Sort services by date descending (most recent first)
                    data.sort((a, b) => new Date(b.date) - new Date(a.date));
                    data.forEach(service => {
                        serviceHistoryList.insertAdjacentHTML('beforeend', renderServiceHistoryItem(service));
                    });
                }
            } else {
                showMessage(data.msg || 'Failed to fetch service history.', 'error');
            }
        } catch (error) {
            console.error('Error fetching service history:', error);
            showMessage('Network error while fetching service history.', 'error');
        } finally {
            updateNoServiceHistoryMessage(); // Update message visibility
        }
    }


    document.addEventListener('DOMContentLoaded', async function() {
        // Redirect if not authenticated
        if (!(await checkAuthAndRedirect())) {
            return; // Stop execution if not authorized
        }

        // Set user name
        const token = getToken();
        if (token) {
            const decoded = decodeToken(token);
            if (decoded && decoded.user && decoded.user.name) {
                document.getElementById('user-name').textContent = decoded.user.name;
            }
        }

        // Fetch and display vehicles and service history on page load
        fetchAndDisplayVehicles();
        fetchAndDisplayServiceHistory();

        // Logout functionality
        const logoutButton = document.getElementById('logout-button');
        const logoutButtonMobile = document.getElementById('logout-button-mobile');

        const performLogout = () => {
            localStorage.removeItem('token'); // Remove JWT token
            showMessage('Logged out successfully. Redirecting to login page.', 'success');
            setTimeout(() => {
                window.location.href = 'login.html'; // Redirect to login page
            }, 1500);
        };

        if (logoutButton) {
            logoutButton.addEventListener('click', performLogout);
        }
        if (logoutButtonMobile) {
            logoutButtonMobile.addEventListener('click', performLogout);
        }

        // Add Vehicle Modal Logic
        const addVehicleModal = document.getElementById('add-vehicle-modal');
        const openAddVehicleModalBtn = document.getElementById('open-add-vehicle-modal');
        const cancelAddVehicleBtn = document.getElementById('cancel-add-vehicle');
        const addVehicleForm = document.getElementById('add-vehicle-form');

        openAddVehicleModalBtn.addEventListener('click', () => {
            addVehicleModal.classList.remove('hidden');
        });

        cancelAddVehicleBtn.addEventListener('click', () => {
            addVehicleModal.classList.add('hidden');
            addVehicleForm.reset();
        });

        addVehicleForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const make = document.getElementById('make').value.trim();
            const model = document.getElementById('model').value.trim();
            const year = parseInt(document.getElementById('year').value.trim());
            const licensePlate = document.getElementById('licensePlate').value.trim();

            if (!make || !model || !year || !licensePlate) {
                showMessage('Please fill in all vehicle details.', 'error');
                return;
            }
            if (isNaN(year) || year < 1900 || year > 2099) {
                showMessage('Please enter a valid year.', 'error');
                return;
            }

            const token = getToken();
            if (!token) {
                showMessage('Authentication token missing. Please log in again.', 'error');
                return;
            }

            try {
                const response = await fetch(`${BASE_URL}/api/vehicles`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-auth-token': token
                    },
                    body: JSON.stringify({ make, model, year, licensePlate })
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage(data.msg || 'Vehicle added successfully!', 'success');
                    addVehicleForm.reset();
                    addVehicleModal.classList.add('hidden');
                    fetchAndDisplayVehicles(); // Refresh the vehicle list
                } else {
                    showMessage(data.msg || 'Failed to add vehicle.', 'error');
                }
            } catch (error) {
                console.error('Error adding vehicle:', error);
                showMessage('Network error while adding vehicle.', 'error');
            }
        });

        // Delete Vehicle Logic (Event Delegation)
        const vehicleListContainer = document.getElementById('vehicle-list');
        vehicleListContainer.addEventListener('click', async function(event) {
            const deleteButton = event.target.closest('.delete-vehicle-btn');
            if (deleteButton) {
                const vehicleId = deleteButton.dataset.vehicleId;
                showConfirmation('Delete Vehicle', 'Are you sure you want to delete this vehicle? This action cannot be undone.', async () => {
                    // User confirmed 'Yes'
                    const token = getToken();
                    if (!token) {
                        showMessage('Authentication token missing. Please log in again.', 'error');
                        return;
                    }

                    try {
                        const response = await fetch(`${BASE_URL}/api/vehicles/${vehicleId}`, {
                            method: 'DELETE',
                            headers: {
                                'x-auth-token': token
                            }
                        });

                        const data = await response.json();

                        if (response.ok) {
                            showMessage(data.msg || 'Vehicle deleted successfully!', 'success');
                            fetchAndDisplayVehicles(); // Refresh the vehicle list
                            fetchAndDisplayServiceHistory(); // Refresh service history as well (vehicle might be linked)
                        } else {
                            showMessage(data.msg || 'Failed to delete vehicle.', 'error');
                        }
                    } catch (error) {
                        console.error('Error deleting vehicle:', error);
                        showMessage('Network error while deleting vehicle.', 'error');
                    }
                });
            }
        });

        // Book Service Form Submission
        const bookServiceForm = document.getElementById('book-service-form');
        bookServiceForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const vehicleId = document.getElementById('select-vehicle').value;
            const date = document.getElementById('service-date').value;
            const type = document.getElementById('service-type').value;
            const description = document.getElementById('service-description').value.trim();

            if (!vehicleId || !date || !type) {
                showMessage('Please select a vehicle, date, and service type.', 'error');
                return;
            }

            const token = getToken();
            if (!token) {
                showMessage('Authentication token missing. Please log in again.', 'error');
                return;
            }

            try {
                const response = await fetch(`${BASE_URL}/api/services`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-auth-token': token
                    },
                    body: JSON.stringify({ vehicleId, date, type, description, cost: 0, partsUsed: [], totalBill: 0 }) // User booking always starts with 0 cost/bill/parts
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage(data.msg || 'Service booked successfully! We will contact you shortly.', 'success');
                    bookServiceForm.reset();
                    fetchAndDisplayServiceHistory(); // Refresh service history
                } else {
                    showMessage(data.msg || 'Failed to book service.', 'error');
                }
            } catch (error) {
                console.error('Error booking service:', error);
                showMessage('Network error while booking service.', 'error');
            }
        });

        // Confirmation Modal Logic
        const confirmationModal = document.getElementById('confirmation-modal');
        const confirmYesBtn = document.getElementById('confirm-yes');
        const confirmNoBtn = document.getElementById('confirm-no');
        let currentConfirmAction = null;

        function showConfirmation(title, message, onConfirm) {
            document.getElementById('confirmation-modal-title').textContent = title;
            document.getElementById('confirmation-modal-message').textContent = message;
            confirmationModal.classList.add('show');
            currentConfirmAction = onConfirm;
        }

        confirmYesBtn.addEventListener('click', () => {
            if (currentConfirmAction) {
                currentConfirmAction();
            }
            confirmationModal.classList.remove('show');
        });

        confirmNoBtn.addEventListener('click', () => {
            confirmationModal.classList.remove('show');
            currentConfirmAction = null;
        });

        // View Service Details Modal Logic
        const viewServiceDetailsModal = document.getElementById('view-service-details-modal');
        const closeServiceDetailsBtn = document.getElementById('close-service-details-btn');
        const serviceHistoryList = document.getElementById('service-history-list'); // Re-selecting for clarity

        serviceHistoryList.addEventListener('click', async function(event) {
            const viewDetailsButton = event.target.closest('.view-service-details-btn');
            if (viewDetailsButton) {
                const serviceId = viewDetailsButton.dataset.serviceId;
                // Find the service directly from the globally stored userServices array
                const serviceToView = userServices.find(s => s._id === serviceId);

                if (!serviceToView) {
                    showMessage('Service details not found or failed to load.', 'error');
                    return;
                }

                // Populate the modal fields
                document.getElementById('detail-vehicle').textContent = serviceToView.vehicleId ? `${serviceToView.vehicleId.make} ${serviceToView.vehicleId.model}` : 'N/A';
                document.getElementById('detail-license-plate').textContent = serviceToView.vehicleId ? serviceToView.vehicleId.licensePlate : 'N/A';
                document.getElementById('detail-date').textContent = serviceToView.date ? new Date(serviceToView.date).toLocaleDateString() : 'N/A';
                document.getElementById('detail-status').textContent = serviceToView.type ? serviceToView.type.replace(/-/g, ' ') : 'N/A';
                document.getElementById('detail-description').textContent = serviceToView.description || 'No description provided.';
                document.getElementById('detail-estimated-cost').textContent = serviceToView.cost !== undefined ? `₹${serviceToView.cost.toFixed(2)}` : 'N/A';
                document.getElementById('detail-total-bill').textContent = serviceToView.totalBill !== undefined ? `₹${serviceToView.totalBill.toFixed(2)}` : 'N/A';

                // Populate parts used
                const detailPartsUsedContainer = document.getElementById('detail-parts-used');
                detailPartsUsedContainer.innerHTML = ''; // Clear previous parts
                if (serviceToView.partsUsed && serviceToView.partsUsed.length > 0) {
                    serviceToView.partsUsed.forEach(part => {
                        const partDiv = document.createElement('div');
                        partDiv.className = 'part-item text-sm text-gray-600';
                        partDiv.innerHTML = `
                            <span>${part.partName} (x${part.quantity})</span>
                            <span>₹${part.unitCost.toFixed(2)} each</span>
                        `;
                        detailPartsUsedContainer.appendChild(partDiv);
                    });
                    document.getElementById('no-parts-message').classList.add('hidden');
                } else {
                    document.getElementById('no-parts-message').classList.remove('hidden');
                }

                viewServiceDetailsModal.classList.add('show');

            }
        });

        closeServiceDetailsBtn.addEventListener('click', () => {
            viewServiceDetailsModal.classList.remove('show');
        });

    });
</script>

<!-- Navbar Scroll Effect Script -->
<script id="navbar-scroll-script">
document.addEventListener('DOMContentLoaded', function() {
    const navbar = document.getElementById('navbar');
    function handleScroll() {
        if (window.scrollY > 50) {
            navbar.classList.add('py-2');
            navbar.classList.add('shadow-lg');
        } else {
            navbar.classList.remove('py-2');
            navbar.classList.remove('shadow-lg');
        }
    }
    window.addEventListener('scroll', handleScroll);
});
</script>

<!-- Smooth Scroll Script -->
<script id="smooth-scroll-script">
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            if (targetId === '#') return;
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 80, /* Adjust for fixed header height */
                    behavior: 'smooth'
                });
            }
        });
    });
});
</script>
</body>
</html>
